function sendEstrategia(){var t=document.getElementById("form_modal--save-button"),e=document.getElementById("form_modal--name-input").value,a=document.getElementById("form_modal--id-input").value;if(""==e)alert("Preencha todos os campos!");else{var d={nome:e,id:a},o=new XMLHttpRequest,n="";"editar"==t.getAttribute("data-acao")?(n="PUT",d.id=a):"criar"==t.getAttribute("data-acao")&&(n="POST"),o.onload=function(){if(o.status>=200&&o.status<300){var t=JSON.parse(o.responseText);console.log("Sucesso: "+o.status),console.log(o.responseText),updateTable(t,n)}else console.log("Falha: "+o.status)},console.log(d),o.open(n,"/blotter/api/estrategias/",!0),o.setRequestHeader("Content-Type","application/json; charset=utf-8"),o.send(JSON.stringify(d)),$("#modalEdit").modal("hide")}}function deleteEstrategia(){if(window.confirm("Deseja deletar essa estratégia? Essa ação não poderá ser desfeita.")){var t=document.getElementById("form_modal--delete-button").getAttribute("data-delete"),e=new XMLHttpRequest;e.onload=function(){e.status>=200&&e.status<300?(console.log("Sucesso!: "+e.status),$("#modalEdit").modal("hide"),deleteFromTable(t)):console.log("Falha!: "+e.status)},e.open("DELETE","/blotter/api/estrategias/"+t,!0),e.send()}}function updateTable(t,e){var a=document.getElementById("table_estrategias"),d=a.getElementsByTagName("tbody")[0];if("POST"==e){var o,n;(o=document.createElement("tr")).setAttribute("class","editavel"),o.setAttribute("data-toggle","modal"),o.setAttribute("data-target","#modalEdit"),o.setAttribute("data-id",t.id),o.setAttribute("data-nome",t.nome),o.setAttribute("data-acao","Editar"),(n=document.createElement("td")).innerHTML=t.nome,o.appendChild(n),d.insertBefore(o,d.firstElementChild)}else if("PUT"==e){var i=a.querySelector("tr[data-id='"+t.id+"']");i.getElementsByTagName("td")[0].innerHTML=t.nome,i.setAttribute("data-nome",t.nome),i.setAttribute("data-permalink",t.id)}}function deleteFromTable(t){var e=document.getElementById("table_estrategias");tr=e.querySelector("tr[data-id='"+t+"']"),tr.remove()}window.onload=function(){document.getElementById("form_modal--save-button").addEventListener("click",sendEstrategia),document.getElementById("form_modal--delete-button").addEventListener("click",deleteEstrategia)},$("#modalEdit").on("show.bs.modal",function(t){var e=$(t.relatedTarget),a=e.data("acao"),d=$(this),o=document.getElementById("form_modal--save-button"),n=document.getElementById("form_modal--delete-button");if(d.find("#modalEditLabel").text(a+" estratégia"),"Editar"==a){var i=e[0].getAttribute("data-id"),s=e[0].getAttribute("data-nome");o.setAttribute("data-acao","editar"),n.setAttribute("data-delete",i),n.disabled=!1,d.find("#form_modal--name-input").val(s),d.find("#form_modal--id-input").val(i)}else d.find("#form_modal--name-input").val(""),o.setAttribute("data-acao","criar"),n.disabled=!0});